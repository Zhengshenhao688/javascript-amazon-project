<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Lesson 18a</title>
  </head>
  <body>
    <script>
      /*
      const xhr = new XMLHttpRequest();

      xhr.addEventListener('load', () => {
        console.log('Response from backend:', xhr.response);
      });

      xhr.open('GET', 'https://supersimplebackend.dev/greeting');

      xhr.send();

      fetch("https://supersimplebackend.dev/greeting")
        .then((response) => {
          return response.text();
        })
        .then((data) => {
          console.log("Response from fetch:", data);
        });

        async function getGreeting() {
        const response = await fetch('https://supersimplebackend.dev/greeting');
        const text = await response.text();
        console.log(text);
      }
      getGreeting();

      async function postGreeting() {
        const response = await fetch(
          "https://supersimplebackend.dev/greeting",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ name: "Zsh" }),
          }
        );

        const data = await response.text();
        console.log("POST response:", data);
      }

      postGreeting();
      */
      /*
      async function postGreetingWithLanguage() {
        const response = await fetch(
          "https://supersimplebackend.dev/greeting",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              name: "Zsh",
              language: "es",
            }),
          }
        );

        const data = await response.text();
        console.log("POST response with language:", data);
      }

      postGreetingWithLanguage();
      */

      /*
      async function getGreetingWithErrorHandling() {
        try {
          const response = await fetch(
            "https://supersimplebackend.dev/greeting"
          );
          const test = await response.text();
          console.log(text);
        } catch (error) {
          console.log("CORS error. Your request was blocked by the backend.");
        }
      }

      getGreetingWithErrorHandling();
      */

      async function postGreetingWithoutBody() {
        try {
          const response = await fetch(
            "https://supersimplebackend.dev/greeting",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
            }
          );

          if (response.status >= 400) {
            throw response;
          }

          const data = await response.text();
          console.log("POST response", data);
        } catch (error) {
          if (error.status === 400) {
            const errorData = await error.json();
            console.log("Error 400 JSON:", errorData);
          } else {
            console.log("Network error. Please try again later!");
          }
        }
      }

      postGreetingWithoutBody();
    </script>
  </body>
</html>
